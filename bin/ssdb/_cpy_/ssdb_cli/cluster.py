# encoding=utf-8
# Generated by cpy
# 2022-12-26 09:21:00.766538
import os, sys
from sys import stdin, stdout

#### start cpy import ###
from engine import CpyEngine
cpy = CpyEngine()
dstfile = cpy.compile('/tmp/gbc/bin/ssdb/ssdb_cli/util.cpy', '', '/tmp/gbc/bin/ssdb/_cpy_/ssdb_cli')
#### end cpy import ###
from util import *

def kv_node_list(resp, time_consume):
	pass
	len_index = 0
	count = 0

	while len(resp.data)>len_index:
		pass
		kv_len = int(resp.data[len_index])

		if kv_len<6:
			pass
			sys.stdout.write('bad response!\n')
			break

		if len(resp.data)>=(len_index + kv_len):
			pass
			count += 1
			id = resp.data[(len_index + 1)]
			status = resp.data[(len_index + 2)]
			range_s = resp.data[(len_index + 3)]
			range_e = resp.data[(len_index + 4)]
			ip = resp.data[(len_index + 5)]
			port = resp.data[(len_index + 6)]
			status_text = 'UNKNOWN'

			if status=='0':
				pass
				status_text = 'INIT'
			elif status=='1':
				pass
				status_text = 'SERVING'
			sys.stdout.write('id: %s\n' % (id))
			sys.stdout.write('    status: %s\n' % (status_text))
			sys.stdout.write('    range:  (\"%s\", \"%s\"]\n' % (range_s.encode('string-escape'), range_e.encode('string-escape')))
			sys.stdout.write('    ip:     %s\n' % (ip))
			sys.stdout.write('    port:   %s\n' % (port))
		len_index += (6 + 1)
	sys.stderr.write('%d result(s) (%.3f sec)\n'%(count, time_consume))
